{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\markm\\\\OneDrive\\\\Desktop\\\\gamedeveloper\\\\react-game\\\\src\\\\game-tools\\\\utils\\\\hooks\\\\gamepad-press\\\\useGamePad.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useRef, useState } from \"react\";\nimport useInterval from \"../hooks/useInterval\";\nimport { GamepadsContext } from \"../context/GamepadsContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function GamepadController() {\n  _s();\n\n  const [gamepads, setGamepads] = useState({});\n  const requestRef = useRef();\n  const {\n    gamepads: globalGamepads,\n    updateGlobalGamepads\n  } = useContext(GamepadsContext);\n  var haveEvents = (\"ongamepadconnected\" in window);\n\n  const addGamepad = gamepad => {\n    // console.log(\n    //   \"Gamepad connected at index %d: %s. %d buttons, %d axes.\",\n    //   gamepad.index,\n    //   gamepad.id,\n    //   gamepad.buttons.length,\n    //   gamepad.axes.length\n    // );\n    updateGlobalGamepads({ ...gamepads,\n      [gamepad.index]: {\n        buttons: gamepad.buttons,\n        id: gamepad.id,\n        axes: gamepad.axes\n      }\n    });\n    setGamepads({ ...gamepads,\n      [gamepad.index]: {\n        buttons: gamepad.buttons,\n        id: gamepad.id,\n        axes: gamepad.axes\n      }\n    }); // Receive controller input\n    // requestAnimationFrame(updateStatus);\n  };\n  /**\r\n   * Adds game controllers during connection event listener\r\n   * @param {object} e\r\n   */\n\n\n  const connectGamepadHandler = e => {\n    addGamepad(e.gamepad); // console.log(\"connecting gamepads\", e, e.gamepad);\n  };\n  /**\r\n   * Finds all gamepads and adds them to context\r\n   */\n\n\n  const scanGamepads = () => {\n    // Grab gamepads from browser API\n    var detectedGamepads = navigator.getGamepads ? navigator.getGamepads() : navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : []; // Loop through all detected controllers and add if not already in state\n\n    for (var i = 0; i < detectedGamepads.length; i++) {\n      if (detectedGamepads[i]) {\n        addGamepad(detectedGamepads[i]);\n      }\n    }\n  }; // Add event listener for gamepad connecting\n\n\n  useEffect(() => {\n    window.addEventListener(\"gamepadconnected\", connectGamepadHandler);\n    return window.removeEventListener(\"gamepadconnected\", connectGamepadHandler);\n  }); // Update each gamepad's status on each \"tick\"\n\n  const animate = time => {\n    if (!haveEvents) scanGamepads();\n    requestRef.current = requestAnimationFrame(animate);\n  };\n\n  useEffect(() => {\n    requestRef.current = requestAnimationFrame(animate);\n    return () => cancelAnimationFrame(requestRef.current);\n  }); // Check for new gamepads regularly\n\n  useInterval(() => {\n    if (!haveEvents) scanGamepads();\n  }, 1000); // console.log(\"component rendering\", gamepads);\n\n  const gamepadDisplay = Object.keys(globalGamepads).map(gamepadId => {\n    // console.log(\"displaying gamepad\", gamepads[gamepadId]);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: globalGamepads[gamepadId].id\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }, this), globalGamepads[gamepadId].buttons && globalGamepads[gamepadId].buttons.map((button, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [index, \": \", button.pressed ? \"True\" : \"False\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 21\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }, this);\n  }); // console.log(globalGamepads);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"Gamepads\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Gamepads\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }, this), gamepadDisplay]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 117,\n    columnNumber: 9\n  }, this);\n}\n\n_s(GamepadController, \"yYgNLs+Kkp3Ip1NY4yewcNJ0Pao=\", false, function () {\n  return [useInterval];\n});\n\n_c = GamepadController;\n\nvar _c;\n\n$RefreshReg$(_c, \"GamepadController\");","map":{"version":3,"sources":["C:/Users/markm/OneDrive/Desktop/gamedeveloper/react-game/src/game-tools/utils/hooks/gamepad-press/useGamePad.js"],"names":["React","useContext","useEffect","useRef","useState","useInterval","GamepadsContext","GamepadController","gamepads","setGamepads","requestRef","globalGamepads","updateGlobalGamepads","haveEvents","window","addGamepad","gamepad","index","buttons","id","axes","connectGamepadHandler","e","scanGamepads","detectedGamepads","navigator","getGamepads","webkitGetGamepads","i","length","addEventListener","removeEventListener","animate","time","current","requestAnimationFrame","cancelAnimationFrame","gamepadDisplay","Object","keys","map","gamepadId","button","pressed"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useRef, useState } from \"react\";\r\nimport useInterval from \"../hooks/useInterval\";\r\nimport { GamepadsContext } from \"../context/GamepadsContext\";\r\n\r\nexport default function GamepadController() {\r\n    const [gamepads, setGamepads] = useState({});\r\n    const requestRef = useRef();\r\n    const { gamepads: globalGamepads, updateGlobalGamepads } = useContext(\r\n        GamepadsContext\r\n    );\r\n\r\n    var haveEvents = \"ongamepadconnected\" in window;\r\n\r\n    const addGamepad = gamepad => {\r\n        // console.log(\r\n        //   \"Gamepad connected at index %d: %s. %d buttons, %d axes.\",\r\n        //   gamepad.index,\r\n        //   gamepad.id,\r\n        //   gamepad.buttons.length,\r\n        //   gamepad.axes.length\r\n        // );\r\n        updateGlobalGamepads({\r\n            ...gamepads,\r\n            [gamepad.index]: {\r\n                buttons: gamepad.buttons,\r\n                id: gamepad.id,\r\n                axes: gamepad.axes\r\n            }\r\n        });\r\n\r\n        setGamepads({\r\n            ...gamepads,\r\n            [gamepad.index]: {\r\n                buttons: gamepad.buttons,\r\n                id: gamepad.id,\r\n                axes: gamepad.axes\r\n            }\r\n        });\r\n\r\n        // Receive controller input\r\n        // requestAnimationFrame(updateStatus);\r\n    };\r\n\r\n    /**\r\n     * Adds game controllers during connection event listener\r\n     * @param {object} e\r\n     */\r\n    const connectGamepadHandler = e => {\r\n        addGamepad(e.gamepad);\r\n        // console.log(\"connecting gamepads\", e, e.gamepad);\r\n    };\r\n\r\n    /**\r\n     * Finds all gamepads and adds them to context\r\n     */\r\n    const scanGamepads = () => {\r\n        // Grab gamepads from browser API\r\n        var detectedGamepads = navigator.getGamepads\r\n            ? navigator.getGamepads()\r\n            : navigator.webkitGetGamepads\r\n                ? navigator.webkitGetGamepads()\r\n                : [];\r\n\r\n        // Loop through all detected controllers and add if not already in state\r\n        for (var i = 0; i < detectedGamepads.length; i++) {\r\n            if (detectedGamepads[i]) {\r\n                addGamepad(detectedGamepads[i]);\r\n            }\r\n        }\r\n    };\r\n\r\n    // Add event listener for gamepad connecting\r\n    useEffect(() => {\r\n        window.addEventListener(\"gamepadconnected\", connectGamepadHandler);\r\n\r\n        return window.removeEventListener(\r\n            \"gamepadconnected\",\r\n            connectGamepadHandler\r\n        );\r\n    });\r\n\r\n    // Update each gamepad's status on each \"tick\"\r\n    const animate = time => {\r\n        if (!haveEvents) scanGamepads();\r\n        requestRef.current = requestAnimationFrame(animate);\r\n    };\r\n\r\n    useEffect(() => {\r\n        requestRef.current = requestAnimationFrame(animate);\r\n        return () => cancelAnimationFrame(requestRef.current);\r\n    });\r\n\r\n    // Check for new gamepads regularly\r\n    useInterval(() => {\r\n        if (!haveEvents) scanGamepads();\r\n    }, 1000);\r\n\r\n    // console.log(\"component rendering\", gamepads);\r\n\r\n    const gamepadDisplay = Object.keys(globalGamepads).map(gamepadId => {\r\n        // console.log(\"displaying gamepad\", gamepads[gamepadId]);\r\n        return (\r\n            <div>\r\n                <h2>{globalGamepads[gamepadId].id}</h2>\r\n                {globalGamepads[gamepadId].buttons &&\r\n                globalGamepads[gamepadId].buttons.map((button, index) => (\r\n                    <div>\r\n                        {index}: {button.pressed ? \"True\" : \"False\"}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        );\r\n    });\r\n\r\n    // console.log(globalGamepads);\r\n    return (\r\n        <div className=\"Gamepads\">\r\n            <h1>Gamepads</h1>\r\n            {gamepadDisplay}\r\n        </div>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}